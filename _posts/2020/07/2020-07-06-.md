昨日の夜も日記を書かずに寝てしまった。

なので [7 月 4 日](/2020/07/04) のように、昨日の分を今日の日記として書こうと思ったが、夜になると疲れて日記を書けずに寝てしまうということが往々にしてあるので、昨日の分に関しては書くことができるという仕様に変更した。

本当はその日の分しか書けないという仕様を貫きたいが、今までも DB に直接入ってレコードを作成したりしていたので、もう仕様を変更しようという決断をした。

実装方法に関してだが、「今日の分として」とりあえず内容は適当で更新して、それを昨日の分として日付を書き換える機能を新しく作成しようとした。

でも、せっかく日記移行機能を実装するなら、今日の分を昨日の分に移行するという局所的な使い方しかできない機能じゃなくて、任意の日記を任意の日付に書き換えるという機能にすることにした。

そしてその機能を呼び出せるリンクを、当日の日記で、かつ昨日の日記が存在しない場合に限り表示されるようにした。そうすることで、機能としては任意の日付に変更できるが、その機能を実行できるのは、当日の日記を昨日の日記に移動させる場合のみということになる。このほうが汎用性が高いだろう。

その機能をもう本番にデプロイして昨日の分の日記を作ったので、あとはその日記を編集して昨日の分を書くことにする[^1]。本当は当日にちゃんと日記を書き残しておくのがベストだが、どうしても疲れていて更新できない、でも日々の記録はちゃんと残しておきたいという思いがあるので、こうするのが一番かなと思った。

[^1]: 先に今日の分の日記を書いている。これから昨日の分も書く予定だ。

今日はこの機能の実装で一日使ってしまった。今日の日記を昨日の分として移行するくらいすぐに実装できるかと思っていたが、最初は「昨日」に移行するだけの局所的なものを作る想定だったが、実際にはパラメータを受け取って処理するようなものになってしまったので、バリデーション機構とか作る必要があって、思いの外、実装が難航してしまった。

---

この日記書いていて、「昨日」と「機能」を頻繁にタイポして非常に鬱陶しかった。あと「分」と打ちたいのに「文」になることが多々あってイライラした。

---

Google Search Console というのが気になっている。

Google Analytics を導入して、検索エンジンからアクセスされているのがわかるのだが、具体的にどのようなワードで検索されているのかがわからない。

どうやら Google Analytics だけではそこまではわからなくて、どのような検索ワードでここを訪れたかまで知るには Google Search Console というものが必要らしい。Google Search Console は Google Analytics と紐付けることができるため、紐付けができればあとは Google Analytics の画面だけで検索ワードなどがわかるようになるらしい。

[初心者向けGoogle Search Console【第1回】「できることと導入方法を知ろう」](https://www.asobou.co.jp/blog/web/gsc01)

最近、Google Analytics で数字を見るのが好きになってきているから、ちょっとこれ導入してみようかなと思った。日記のアクセスデータはあまり見ないほうが良いとか前に言っていた気がするけどやっぱ気になっちゃう。データの分析とか数字見るのが好きなんだと思う。

Google Search Console を使い始めるにはなんか設定が必要っぽいのでまた今後やることにする。

---

ここまで日記書いたあとに、追加で開発を進めた。今日は一日中コード書いてて疲れているはずなんだけど、まだ実装はしたい気分だった。

日記本文 (`article.text`) を空にすることを許容するようにした。ただし、テンプレート (`templated_articles.body`) も含めて、すべてのコンテンツが空になることは許容しないようにバリデーションを書き換えた。

なぜ日記本文を空にしたかったかというと、疲れていて日記本文を書く気力はないけど、食べたものだけとりあえず記録しておきたいとか、一日の終わりではない（まだ日中）だけどとりあえず今日の気分を記録しておきたいとか、そういうときにいちいち日記本文に何かしらの文字を入れておかないと投稿できないのはめんどくさいなと思ったからだ。

 (this is a private diary) 

テンプレート機能をまだデプロイしていなかったころ（つまり日記本文しか投稿できなかったころ）は、日記本文を空にしてしまうともはや何もなくなってしまって意味がわからなかった[^2]が、テンプレートが使えるようになってからは、テンプレートにだけとりあえず記録を残しておきたいみたいなことが発生するようになり、それで今回の仕様に変更することにした。

[^2]: まあ意味があるとすれば、日記はその日の分しか書けないから、とりあえずレコードだけ作っておくみたいなときは使えたかもしれないが、それだと本末転倒だ。



# 食べたもの
- プロテイン
- フルグラ（プロテイン入り）



# 今日の学び
`Hash.delete` だと戻り値が、削除した key と value になってしまうが、逆に削除後に残った hash を戻り値として受け取りたいときは `Hash.except` を使えば良いということを知った。

[Hashからキーを削除し、Ruby/Railsで残りのハッシュを取得する方法は？](https://www.it-swarm.dev/ja/ruby-on-rails/hash%E3%81%8B%E3%82%89%E3%82%AD%E3%83%BC%E3%82%92%E5%89%8A%E9%99%A4%E3%81%97%E3%80%81rubyrails%E3%81%A7%E6%AE%8B%E3%82%8A%E3%81%AE%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95%E3%81%AF%EF%BC%9F/972910108/)



# 成長記録
今日も開発がんばった！

毎日同じことを書いてしまいそうな気がするが、それでも良いんだと思う。自己肯定感を高めるためには、その日がんばったことを書けば良いんだから。そうやってがんばったこととかえらかったことを少しずつ積み重ねていって自分への自信を取り戻そう。



# 気分レベル
6



# 今日の気分はどうだったか
まあまあだったかな。今日は 13 時間以上寝たはずなので開発する意欲と集中力は結構あった。

ただ、テンションはそんなに高くなかった。なんかちょっと気分は沈みがちだったような感じがする。
