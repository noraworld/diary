# HDMI 切替器が届いた
午前中に [HDMI 切替器](https://www.amazon.co.jp/gp/product/B083355GMH) が届いた。急に必要になったというものでもないのだが、部屋の模様替えをして再び Mac mini を使うようになってから、テレビの HDMI の端子がまた一つ足りなくなってしまったからだ。

以前にも HDMI 切替器は持っていたのだが、前に持っていた 32 インチ型のテレビを会社の人に売ったときに、一緒にあげてしまったのだ。そのときは Mac mini を使わなくなってしまったころだから、もう必要ないと思ってしまったのだ。

今回購入した HDMI 切替器は前に持っていたものとは少し違うものなのだが、接続して使ってみたら、HDMI CEC が切替器内で動作するものだった。

切替器には Fire TV、Nintendo Switch、Mac mini を接続しているのだが、たとえば、Switch で電源を入れると、今まで Mac mini の出力になっていたものが自動的に Switch の出力に切り替わる。これは以前の切替器にはなかった機能なのでとても便利だ。

さらに手動で切り替えるためのリモコンもついているので、HDMI CEC に対応していない Mac mini なんかは、リモコンで切り替えることもできる。リモコンの赤外線情報を Nature Remo に登録したので、Siri で HDMI 切替器の出力先を切り替えることもできる。これも便利だ。

ちなみに、Mac mini で HDMI CEC が使えないという話は Apple の公式サポートページに書いてあったことなので、macOS 特有なのかとも思ったが、やはり Windows でも動作しないようだ。残念だが仕方ない。

# 「英数」「かな」キー問題を USB アダプタで解決したい
Windows を Boot Camp で使うようになってから、Magic Keyboard の「英数」「かな」キーが効かない問題に悩まされていた。Bluetooth 接続ではなく USB 接続（有線接続）なら反応するというところまではわかったものの、やはり Bluetooth で使いたいのでどうにもならない。

しかし諦めきれなくて、今日もひたすらそのことについてあれこれやっていた。そしたら Windows を再起動した際に、そもそもキーボード自体が接続されないという問題が新たに発生してしまった。

Windows が起動したあとに Bluetooth から Magic Keyboard を削除して、Bluetooth をオフにしてから再びオンにして再接続することで使えるようになるものの、毎回これをやるのは正直結構面倒だ。

というわけで、[Bluetooth アダプタ](https://www.amazon.co.jp/gp/product/B00J84V7OM) を使う方法を試してみようと思う。これは Bluetooth 非搭載 PC でも Bluetooth 機器を使えるようにするための USB ドングルだ。

Mac は Bluetooth 搭載だから、もちろん本来なら不要なものなのだが、おそらくこの USB アダプタ経由で Magic Keyboard をペアリングさせれば、Windows 的には（OS 的には）USB でデバイス（Magic Keyboard）を接続した扱いになると考えられる。Magic Keyboard を USB で接続すれば問題なく「英数」「かな」キーが反応することは調査済みなので、もしかしたらこれで「英数」「かな」キーが反応するようになるかもしれない。

まあただの思いつきで、これでうまくいく確証はないし、ネットで調べても当然うまくいくと書かれているサイトは見つからない。しかし妥協はしたくないし、可能性があるなら試してみたい。

これでダメだったら、、、もう諦めるしかないかな、、、。

# AutoHotKey で macOS 風のキーバインドにした
Windows を使っていると、やっぱり macOS の Ctrl キーが使えないのが不便に感じてしまう。なので、AutoHotKey を使って疑似的に macOS の Ctrl キーのキーバインドを実現してみた。

とりあえず自分がよく使うカーソルキーの移動に関するものを登録してみた。概ね動作はするのだが、キーを押しっぱなしにしていると、たまに変な挙動を見せるのが気になるが、まあやりたいことは実現できたのでひとまずはこれでいくことにする。

書いたスクリプトはこんな感じ。上の 2 行は Command + Tab (Ctrl + Tab) でアプリケーション間の切り替えができるようにするもの。

Windows では、本来はこの操作は Alt + Tab になっているのだが、Command キー (Ctrl キーとして割り当てている) の位置は変えたくないので、Tab キーと同時押しした場合に限り、この Ctrl キーが Alt キーに化ける、というようなスクリプトになっている。

その下の数行は、いわゆる Ctrl キーによるカーソル移動のキーバインドだ。自分の指が完全にこの Ctrl キーによるカーソル移動に慣れてしまっているのでこれが使えないとストレスでしかない。

```
Ctrl & Tab::AltTab
Ctrl & SC029::ShiftAltTab

!p::Send,{Up}
!b::Send,{Left}
!n::Send,{Down}
!f::Send,{Right}
!a::Send,{Home}
!e::Send,{End}
!m::Send,{Enter}
!h::Send,{BS}
!d::Send,{Delete}

Return
```

dotfiles で管理しておこう。あとは「英数」「かな」キーが使えるようになれば、キー配置はだいぶ macOS に近づいてストレスなくキーボードが扱えるようになるだろう。
