# リングフィットアドベンチャー
第 25 回目。

<iframe width="560" height="315" src="https://www.youtube.com/embed/3Xe5Cn_p9HQ" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

# "iMovieライブラリ.imovielibrary" を削除した
Mac のストレージの空き容量が残り 22 GB になっていた。YouTube に動画を上げ始めたころから急に減り始めたので、原因は動画なんじゃないかと気づいていた。なので、ムービーフォルダを見てみると、容量が 350 GB も食っていた。

![05ABCAC4-EDA7-47EA-8709-DB3B08E4C391.png](https://noraworld.github.io/box-bulbasaur/2020/11/aeba9f1e22b1d6861a9ce02748037a94ee2743a399bdaaf3e1801d9ef6e47665.png)

 (this is a private diary)

その中でも特に、"iMovieライブラリ.imovielibrary" というファイル (パッケージされているファイルで、実際にはフォルダと同等) が 300 GB も食っていた。

![C262FD76-FCEE-4941-8839-DD5F41F15691.png](https://noraworld.github.io/box-bulbasaur/2020/11/6bd2abe65923e4320b0ca3b2f82d6b99b332847d94e7d18e7c4358426289d211.png)

以前に iMovie で 3 時間半くらいの動画を編集したことがあったが、この Mac で iMovie を使ったのはそれが最初で最後なので、それ以外の動画は開いていない。となると、たった 1 本の動画で 300 GB も謎のキャッシュファイルか何かがこの中に生成されたということか。

適当に調べた情報だと、iMovie は開いた動画ファイルを丸ごとこの "iMovieライブラリ.imovielibrary" の中にコピーするらしい。編集前の動画ファイルそのものを削除してもこのプロジェクトファイルがあれば動画を復元することができるとかそういうことだと思うのだが、さすがに動画ファイル丸ごとコピーするのはやりすぎだ。動画ってめちゃくちゃファイルサイズでかいので、すぐにいっぱいになってしまう。

3 時間半の動画を編集したのは、YouTube で Fall Guys の配信しようと思ったらアカウントが有効化されていなくて動画で録画したものなのだが、そのときに PS アカウントに登録した本名が入ってしまっていたのでそれを隠すための編集を入れていた[^1]。

[^1]: いきなり配信ができていたらそのことに気づかずそのまま公開されてしまっていたので、配信ができない状態だったのがむしろ良かったと後から思った。

その録画した動画自体は 8.39 GB で、編集後の動画も 32.64 GB なので (なぜか編集後はファイルサイズが肥大化しているが、それでも) その動画だけで 300 GB のプロジェクトファイルになるのは手に負えない。

もうこんなでかい動画ファイルを扱うこともない (最近は配信しているし) だろうし、iMovie も今のところ使う予定はないので、このファイルを Google Drive に丸ごと投げてローカルからは削除することにした。

すでに空き容量が 22 GB しかないので、Google Drive のボリュームにコピーすることはできない。なので直接 Google Drive のボリュームにファイルを移動させることにした。

しかし、移動するだけでも一時的に空き容量が必要だったらしく、ついに Mac のストレージが完全に埋まってしまった。当然移動もできずキャンセルされた。ついでに Google Drive File Stream が落ちた。

![2FE6B9AA-A283-4BF3-B6AA-F4B174873C7A.png](https://noraworld.github.io/box-bulbasaur/2020/11/4726db011b35cdeff8465487bc25b66c4c8ed79575db9d38a847a8017f0c7c7c.png)

これはあとから気づいたことだが、たぶん Google Drive File Stream のキャッシュに保存されてしまった (結局コピーと同じように 2 倍の容量 600 GB が一時的に必要だった) ので容量を食いつぶれてしまったのだと思う。

Google Drive File Stream ではローカルに十分な空きがなくて無理なので、ブラウザからファイルをアップロードしたが、これも失敗。やっぱりブラウザにアップロードするときにも一時的にキャッシュとして十分な空き容量が必要らしい。

というわけで、この Mac だけではどうやってもこの 300 GB のファイルを Google Drive に上げることができなかった。

となると USB 外部ストレージを買う必要があるが、このためだけに外部ストレージを買うのもなあと思ったのと、たった 1 本の動画を、しかも黒塗り処理だけをする動画編集ファイルを残しておいても意味ないし、編集前の動画と編集後の動画はそれぞれ残っているので別にこのファイルをバックアップする必要はないか、と思い、削除することにした。

このファイルを削除しようとしたときに、本来はゴミ箱に移動されるが、このファイルはそのまま削除されてもとに戻すことは出来ませんという警告が出た。十分な空き容量がないからゴミ箱に移動することもできないのだろう。そのときの警告のスクショを取ったが、完全に空き容量が 0 の状態だったので保存されていなかった。

まさかこんな短期間でこんなでかいファイルが生成されているとは思わなかった。今回の場合は仕方ない気もするが、ストレージの空き容量が減ってきたと思ったらなるべく早めにバックアップしてローカルのデータを整理したほうが良いなと思った。

# iCloud 写真からドラッグアンドドロップすると圧縮された画像になってしまう
以前に iCloud 写真から画像をドラッグアンドドロップすると、圧縮された画像がアップロードされてしまって、これは「Mac ストレージを最適化」オプションを使っているからだと言っていた。しかし実は違ったようだ。

![E880F768-266B-4634-B671-9F08DE611532.png](https://noraworld.github.io/box-bulbasaur/2020/11/b2423c1bee7054a822fac9871ad0650453b8b5eed25868f49f264d7c02022808.png)

「オリジナルをこの Mac にダウンロード」オプションを選んでいたとしても、iCloud 写真アプリから写真をドラッグアンドドロップすると圧縮されたファイルがドロップされてしまうようだ。ちゃんと Mac にはオリジナルファイルが存在しているが、アプリからドラッグアンドドロップすると圧縮されたものがドロップされてしまうということみたい。

しかも、よく見たら、「Mac ストレージを最適化」オプションを選んだとしても、空き容量が少なくないときはこのオプションを選んでいてもオリジナルファイルがダウンロードされているようだ。あくまで空き容量が少ないときだけ圧縮された画像しかダウンロードされないということみたい。

で、オリジナルファイルをアップロードしたかったら、ドラッグアンドドロップではなく、ファイルを選択するウィザード (っていう言い方で良いのかわからない) を開いて、そこからファイルを選択してアップロードしないといけないらしい。iCloud 写真にあるファイルを選択するときは小さい画像でしかプレビューされないので地味にめんどくさい。

というわけで、iCloud 写真にある写真のオリジナルをドラッグアンドドロップすると、オリジナルファイルが Mac にあろうとなかろうと圧縮されたファイルがドロップされてしまうということを知った。

## 圧縮されちゃったやつら
今日ここにアップロードするまで知らなかった (「オリジナルをこの Mac にダウンロード」オプションにしておけばドラッグアンドドロップでもオリジナルがドロップされると思いこんでいた) ので、圧縮されてアップロードされてしまったファイルを一応ここに残しておく。

![05ABCAC4-EDA7-47EA-8709-DB3B08E4C391_1_105_c.jpeg](https://noraworld.github.io/box-bulbasaur/2020/11/0f282c1b878db3fd825b0a33e8326fb05c4a9b5b14005fdbd81cc80e3a71ace7.jpeg)

![C262FD76-FCEE-4941-8839-DD5F41F15691.png](https://noraworld.github.io/box-bulbasaur/2020/11/4b3015e159c19f464ac2485739533747cc28c15b60f9502f6a1ecec7cdfd5122.png)

![2FE6B9AA-A283-4BF3-B6AA-F4B174873C7A_1_105_c.jpeg](https://noraworld.github.io/box-bulbasaur/2020/11/706d319a25499845079ba30e9999adb323d8fa7184ab9f3f8cf3edc9a1138ab1.jpeg)

![3D27B67B-3FF5-4BAC-9A9B-30B48EED34DD_1_105_c.jpeg](https://noraworld.github.io/box-bulbasaur/2020/11/157b18ee6bed9f56004e405bf81205a459a0c45d2d112a1d00a8458ea0407341.jpeg)

![8FA2C280-D2DB-41F5-896A-23662FF7191A_1_105_c.jpeg](https://noraworld.github.io/box-bulbasaur/2020/11/70725d4df3f8b317396a3df31c61c8d11e8c8b5bcf160c1f124b6da14046707a.jpeg)

![7AEBE93F-5B4D-427F-8889-23A756B69827.jpeg](https://noraworld.github.io/box-bulbasaur/2020/11/d642dee919f9b8065a797d975ee60efa1b60b98ca6e250beaeeb69cb207ce0c6.jpeg)

オムライスと eGPU と水は、検証するためにテストで適当にあげたやつ。写真やもともと大きくないスクショはまだましだが、そこそこ大きいスクショは圧縮されるとかなり解像度が悪いな。

【追記】
水は圧縮されてないやつだった。水の写真はドラッグアンドドロップではなくウィザード (？) から選択してアップロードして、この写真で、ウィザードから選択すれば圧縮されないことを知った。
