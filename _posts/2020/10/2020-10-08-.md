# Google Photos の移行がなかなかどうしてめんどくさい
昨日の夜くらいに古い Google アカウントの Google Photos にある写真を今使っているほうに移行する作業をした。Google Takeout を使ってダウンロードした Google アカウントのデータの中から、Google Photos のものを丸ごとアップロードした。

すると、600 枚強[^1]の写真がなぜかすべて 2020 年 9 月 10 日としてアップロードされてしまった。本当は写真ごとに違うのに。

アップロードした写真はたぶん 5,000 枚弱[^2]くらいで、大抵の写真は問題なくその写真を撮影した日時でアップロードされているのだが、なぜかそのうちの 600 枚強[^1]は 2020 年 9 月 10 日になってしまった。

[^1]: あとから削除するときにちゃんと枚数計算したら 1,469 枚だった。全然違うやんけ！

[^2]: 実際の枚数はいまだ謎なんだけど、たぶん 3,700 枚くらいなんだと思う。

昔のアカウントの Google Photos には、Twitter などから落としてきたイラスト画像なども含まれていたので、そういう画像は撮影日時のメタデータが入っていないのかなと推測したのだが、自分で撮影した写真も 9 月 10 日になってしまっているものが多かった。画像のメタデータの JSON ファイルを見ると、`modificationDate` が 2020 年 9 月 10 日になってしまっているようだったが、そもそもこのアカウント自体を最後に使ったのが 2018 年 8 月なので、2020 年に編集しているわけがない。

なぜこのような現象になってしまうのかはよくわからなかった。

そこで、Google Photos の共有を試してみることにした。古い Google アカウントの Google Photos で、すべての写真を今使っている Google アカウントに共有するようにして、今使っている Google Photos ですべてを保存するようにする、というものだ。

最初は共有された写真と、もともとある写真とで分かれてしまうと思ったので再アップロードという方法をとったのだが、共有された写真をすべて自分のアカウント側に保存できるなら最初から共有の方法でやれば良かったと思った。

で、すべての共有された写真を保存するには時間がかかるみたいなんだけど、今見てる感じだと、すでに手動でアップロードしてしまったものと同じ写真という認識をされてしまっているっぽくて、なんだかめんどくさいことになりそう。一旦過去の写真を削除して、もう一度共有された写真を保存するようにしないとダメなのかなあ。

まだすべての写真が反映されているわけじゃないから、もうちょっと待ってみる。

ちなみに Google Photos 以外にも移行できるデータはあるが、正直古いメールとかを今のメールボックスと統合する必要もないかなあと思っている。なので Google Photos だけは古い写真と (日時バグをきれいにして) 統合して、それ以外のバックアップデータに関しては、めんどくさいこと考えずにバックアップファイル丸ごと、今使っている Google Drive にアップロードしようかなと思っている[^3]。ちなみに容量は 10 GB。わーお。

[^3]: 後にアップロードした。

## 追記
どうも、すでに手動で Google Photos にアップロードしてしまった前の Google アカウント内の写真があると、共有で保存されないみたい。なので、一旦共有を解除して、めんどくさかったけど手動でアップロードしてしまった古い写真を全部削除して、もう一度共有して、共有した写真をすべて現行のアカウントに保存することにした。

そうすることで、手動でアップロードしたときに発生していた日時がおかしくなる問題 (9 月 10 日になる問題) は解消された。正直、一度アップロードしてしまった過去の写真をチェックして全部削除するのは結構めんどくさかったが、おかげで日時問題を修正することができて良かった。

というか、最初から手動アップロードじゃなくて共有で保存すれば良かった。共有では現行のアカウントのほうには写真が移行できないと (あくまで過去の写真が過去のアカウントから共有されているから閲覧可能になっているだけなのだと) 思っていたので、そこは完全に調査不足だった。

ただ、気になる点としては、間違って現行のアカウントにもともと入っていた写真を削除してしまっていないか、本当にすべての過去の写真が保存されているか、が挙げられる。というのも、写真の枚数が全然合わないのだ。

### 計算合わぬ
手動でアップロードしてしまった過去の写真を削除するときに、削除した写真の枚数は全部で 3,827 枚。ちなみにこのうち、日付が 9 月 10 日になってしまっていた写真は合計 1,469 枚だった。

しかし、過去のアカウントから共有された写真の合計枚数は、3,705 枚なのだ。つまり、122 枚 (3,827 - 3,705) を余計に消してしまっている……？ 会社に入社時の研修の合宿の写真や研修中にあった飲み会の写真が、日付的に過去の写真と混ざっていたが、それはちゃんと排除している。なのになぜ……。

さらにここで若干謎なのは、過去のアカウントの Google Photos の全部の写真の合計が 3,703 枚だったのだ。2 枚 (3,705 - 3,703) はどこからやってきたのか……。

一方で、[Google ダッシュボード](https://myaccount.google.com/dashboard) を見ると、過去のアカウントの Google Photos 内の写真の枚数は 4,359 枚となっている。いったいどういうことだってばよ……。

ちなみに、iCloud 写真 (iPhone のカメラロール) には 4,905 枚の写真があった。そこには合宿や飲み会の写真は含まれていないので、その分を足すと 4,905 + 112 = 5,017 枚となる。現行のアカウントから手動でアップロードした過去の写真を消したあと、Google ダッシュボードで枚数を確認すると、5,234 枚。まあこれは過去のアカウントのほうで Google Photos 内の写真の合計枚数と Google ダッシュボードの枚数の値が違っていたので当てにはならないんだけど、217 (5,234 - 5,017) も数値がずれているのはちょっと気になる。

そして、おそらく共有されたすべての写真を現行のアカウントに保存しきったあと、Google ダッシュボードを見たら 8,933 枚となっていた。つまり 3,699 枚 (8,933 - 5,234) の写真が保存されたわけだ。共有された写真の合計を数えたら 3,705 枚だったので、6 枚 (3,705 - 3,699) 分、数が合っていない。

最後に、Google Takeout を使って過去の Google アカウントから全データをダウンロードしたときの、Google Photos に含まれている全画像 (拡張子が `.jpg` や `.png` になっているもの) の枚数を以下のコマンド[^4]で数えたら、4,351 枚だった。Google ダッシュボードで見た Google Photos の合計枚数 (4,359 枚) に近いが、これも若干数字が合っていない。

```
$ tree | grep -i -e jpg -e png | grep -v json | wc -l
```

[^4]: もしかしたらコマンドが良くないかも？ 説はある。数え間違いしてそう。

という感じで、ことごとく数が合わないのがなんとも気持ち悪いのだが、Google Photos 内で、すべての写真の枚数をカウントした値と、Google ダッシュボード上で表示される Google Photos の写真の合計枚数が一致していない時点で、そもそも Google もカウント間違えてるじゃんって感じなんだけど、これはいったいなんなんだろうな。

まあざっと見た感じでは問題ないし、一枚一枚確認するのはめんどくさいというレベルじゃないのでこれ以上はやらない。だいたい過去の写真も現行のアカウントに (日付もちゃんとしたデータで) 統合することができたので良しとすることにする。

ちなみに共有された過去の写真を全選択 (3,705 枚) して、保存するボタンを押したら「保存できません」と言われた。たぶん枚数が多いので一気に処理することはできないのだろう。なので Google Photos の共有の機能の自動保存をオンにして、全写真が自動で保存されるまでしばらく待っていた。結局、Google Photos が提供している機能に逆らうとことごとくうまくできなかった、というわけだ。ちゃんちゃん。こ。

# スキャナーを買った
最近、何かと書類を扱うことがあって、紙が増えて鬱陶しいので、いい加減スキャナーを導入することにした。

今まではスマホで紙を撮影したりプリンターのスキャン機能を使用していた。スマホでの撮影は、フォトスキャン系のアプリを使っても仕上がりがめちゃくちゃ汚い (影は映るし傾くしブレるしはみ出すし) ので論外。プリンターはきれいにスキャンすることはできるが、レシートみたいな細いものはサイズをうまく認識しなくて切れたりするし、なにせ 1 枚 1 枚のスキャンに時間がかかって手間なのだ。

あと、スキャンしたものは写真フォルダに保存するようにしているが、食べ物の写真などの中に書類が混ざっているのも気持ち悪い。こういうのはドライブの専用フォルダにまとめておきたい。しかも画像じゃなくて PDF で。

そこで、[このスキャナー](https://www.amazon.co.jp/gp/product/B07SB625W2) を選んだ。もうどのサイト見てもこれが堂々の 1 位だった。Amazon の星の数を見ても評価はすごく高い。レビューを見るとソフトウェアの出来がひどいというのが気になったが、それらは 2018 年のレビューが多かったし、ソフトウェアはアップデートで改善できるので、今は大丈夫になっていると信じたい。

明日届く。

 (this is a private diary) 



# そういえば
 (this is a private diary) 
