# Magic Keyboard、Magic Trackpad 2 が届いた
[昨日](/2018/11/02) 言った通り、Magic Keyboard と Magic Trackpad 2 が午前中に届いた。

![img_0332](/images/2018/11/img_0332.jpg)

![img_0333](/images/2018/11/img_0333.jpg)

![img_0337](/images/2018/11/img_0337.jpg)

デザインが洗練されていてとても美しい。

![img_0342](/images/2018/11/img_0342.jpg)

![img_0340](/images/2018/11/img_0340.jpg)

キーボードとトラックパッドの裏面には Apple のロゴが大きく印字されている。

![img_0334](/images/2018/11/img_0334.jpg)

![img_0335](/images/2018/11/img_0335.jpg)

入っていたライトニングケーブルは黒い。何気にこの黒いライトニングは初めて手に入れた。

試しに空でキーボードのタイピングをしてみたのだが、ふつうに打ちやすかった。MacBook Pro のキーボードとそんなに大きくは変わらないので、快適にタイピングができるんじゃないかなと思った。

昨日も言った通り、キーボードとトラックパッドだけ届いても何もできないのだが、これにより Mac mini へのワクワク感がさらに高まった。

# スマブラを購入してダウンロードした
[昨日](/2018/11/02) の日記に埋め込んだスマブラの Direct の動画を観た。今作のスマブラはかなりの気合の入りようで、さらにワクワクしてきた。スマブラが遊べるようになったらほとんどの時間がスマブラに溶けていくような気がしている。

で、この動画の中で先行特典みたいなことが言われていたので、ショップで確認してみたら、ソフトのみのバージョンと、特典がついたバージョンがすでに売られていた。もちろん特典付きのものを購入した。

購入完了すると、なんともうダウンロードが始まったのだ。

![img_0349](/images/2018/11/img_0349.jpg)

そしてダウンロードが完了するとソフト一覧にスマブラが表示された。

![img_0351](/images/2018/11/img_0351.jpg)

完全に余談だが、部屋の電気を消すときれいにテレビの画面が撮れることがわかった。電気がついていると自分がスマホで写真を撮っている姿がテレビに写り込んでしまってなんともかっこ悪い。

発売は 12/7 なのに、なんでダウンロードできるんだ？ と思ったが、ソフトを起動しようとしたら、このソフトはまだ遊べませんと出てきたので、ちゃんと発売日までは待たないといけないらしい。まあ当然といえば当然なのだが。しかしダウンロードはすでにできることには驚いた。

ソフトはもう購入 & ダウンロード済みなので、後は 12/7 を待つのみだ。楽しみだ。

# 小型パソコンを返品することにした
Mac mini が約 1 週間後に届くので小型パソコン (と一緒に買ったキーボード、マウスも) は返品することにした。返品してから Mac mini が届くまでの間は不便になってしまうのだが、返品期限が 11/5 まで[^return-date]なので返品するならもう準備をしないといけない期日が迫っている。

[^return-date]: 小型パソコンが届いたのは [10 月 6 日](/2018/10/06) なのでちょうど 1 ヶ月だ。

とりあえず Amazon のページから返品の依頼を行った。すると、返品受付が完了したと同時に、返品する手順についての説明が出てきた。

やる作業としては、ページに書かれている返品受付 ID を印刷するなりメモるなりして商品と一緒に荷造りして、コンビニ等で返送先住所に届ければ良い。返品は面倒くさそうだと思っていた (今まで返品をしたことなかった) が、作業手順としてはそんなに多くなかったので良かった。

だが、面倒くさいことはまだあった。小型パソコンを返品する前に、中に入っているデータをすべて削除する必要がある。

単純に考えるとホームディレクトリあたりを `rm` コマンドで消去すれば良さそうな気もするが、それだと完全なデータ削除にはならない。OS 側から `rm` コマンドで消去したファイルを元に戻すことはおそらくできないが、HDD の中ではがんばれば復元できる状態で残っているからだ。

で、完全な HDD 内のデータ消去を行うにはどうしたら良いかは知らなかったので調べてみたら、いくつか参考になる記事がヒットした。

- [秘密にしたいファイルを完全に削除する方法](https://tech.nosuz.jp/2015/12/ubuntu-delete-files/)
- [ファイルを完全に消去するには](http://www.atmarkit.co.jp/flinux/rensai/linuxtips/662delfile.html)
- [[FreeBSD][Linux] ファイル/デバイス完全消去には(g)shred](http://d.hatena.ne.jp/flageo/20130117/p1)

ざっと調べた感じ、`dd` コマンドを使う記事と `shred` コマンドを使う記事が見つかったが、「[ファイルを完全に消去するには](http://www.atmarkit.co.jp/flinux/rensai/linuxtips/662delfile.html)」にも書かれている通り、`dd` だとデータは完全に削除されているが、悪意のある人が特殊なことをすればデータを読み取られる可能性があるらしい。

ということで、`shred` コマンドを使えば完全に削除できるということなので以下のコマンドを使用して HDD の中身を消去した。

```bash
$ shred -zv <ディスクユーティリティ的なアプリで調べたディスク名>
```

だが、ちょっと面倒なことが起こった。端的に言えば、このコマンドの実行を途中で中断してしまったのだ。

このコマンドは実行にとても時間がかかる。なにせ 25 回もランダムな値をひたすら書き込むからだ。時間がかかるから、痺れを切らして途中で中断してしまったのかというとそういうわけではなく、オプションをつけ忘れているんじゃないかという心配があったからだ。

コマンド実行中は暇だったので、上記のコマンドについて詳しく調べていたら、`-u` オプションというのがあるのに気がついた。このオプションは「[秘密にしたいファイルを完全に削除する方法](https://tech.nosuz.jp/2015/12/ubuntu-delete-files/)」にもある通り「データを上書き後にファイルを削除する」ものらしい。逆に言えばこのオプションをつけないとファイルを削除してくれないのではないかと思ったのだ。実際、想定していた挙動としてはドックにある自分でインストールしたアプリが一覧から消えるかと思っていたのだが、消えなかったので、ファイルが削除されていないのではないかと心配になったのだ。

そこで、一度コマンドを中断して、このオプションをつけて再実行しようとした。しかしすでに HDD の中身を一通り削除 (ランダム値で書き換え) してしまった後[^shred-progress]なので、再実行しようとしたら、そのディスクは存在しないと出てしまった。削除したのだが当然といえば当然なのだが、これではオプションを付け直して再実行することができない。

[^shred-progress]: shred の進捗表示で `1/4` から `2/4` になったすぐ後くらいにコマンドを中断した。おそらくこの 4 回は同じ作業 (ランダム値で書き換え) をするのだろうが、1 回は最後まで書き換え処理を行ったのでデータは完全に消えたように思われる。しかしこれで絶対に復元できないようになっているのかと言われるとそれはわからない... だからこそもやもやするのだ

本当に消えてしまったのだろうか。試しにファイルを開いてみようとしたらファイルアプリが起動しない。Google Chrome もその他のアプリも一切起動しなくなっていた。再起動しようとして `shutdown` コマンドを実行しようとしても `shutdown` コマンドが見つからないと言われてしまった。どうやら本当に消えてしまったようだ。

コマンドではなく GUI メニューから再起動したら GRUB の真っ黒い画面が出た。ついに OS も正常にブートできなくなった。

まあこれでたぶん大丈夫なのだとは思うのだが、なんか途中でコマンドを中断してしまったことで、本当にデータが復元できないようになっているのかが不安になってきた。しかし確認しようにも、もう Ubuntu すら起動しない。

GRUB の画面で `boot` コマンドを実行すればブートができるようなのだが、`grub error: you need to load kernel first` というエラーが出てしまう。ググったらいろんな記事 (たとえば [これ](https://unix.stackexchange.com/questions/418401/grub-error-you-need-to-load-kernel-first)) が出てきたのだが、どれを試してもダメだった。どうやらもうブートができなくなってしまったようだ。

このまま返品してしまっても良さそうだが、なんか不安なのとちょっと納得がいかないので、やっぱりもう一度 Ubuntu のコマンドラインから正しいオプションで削除して完全に消えたことを見届けたいのだ。

なので USB メモリにまた Ubuntu をインストールし直してもう一度新しく Ubuntu をインストールし直した後、shred コマンドを正しいオプション付きで最後まで実行してから返品することにする。

最初にインストールするために Ubuntu イメージをインストールした USB メモリはすでにふつうのデータが入ってしまっている状態だ。なのでまずはその中身を古い PC 等にコピーした後に Ubuntu イメージをインストールする。

ただしもう今日は遅いのでまた明日やることにする。

正直ここまでやるのは面倒だが、データが復元できる中途半端な状態で返品するのは気持ち悪いので
仕方ない。

# USB メモリが読み取り専用になってしまう問題
小型パソコンに入っていた、取っておきたいデータを USB メモリに移そうとしたのだが、USB が読み取り専用になっていて書き込むことができなかった。これは前にも同じ問題が起きていた。

この状態になると、ググったときによく出てくる解決法である `fsck.hfsplus` コマンドによるディスクチェックをしても治らない。USB が root になっているわけでもないのでしばらくお手上げ状態だったが、結局はこれで治った。

```bash
$ diskutil disableJournal <USB ディスク名>
```

参考元: [【Ubuntu】外付けハードディスクが読み込み専用になる](http://zaka-think.com/linux/linux-mint/%E3%80%90ubuntu%E3%80%91%E5%A4%96%E4%BB%98%E3%81%91%E3%83%8F%E3%83%BC%E3%83%89%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AF%E3%81%8C%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%E5%B0%82%E7%94%A8%E3%81%AB%E3%81%AA/)

どうやら Mac で Ubuntu のイメージをインストールしたのがなんかよくなかったらしい。なんでよくないのかはわからないが Mac が悪さをしていることは確かだ。上記コマンドを実行すると `already disabled` 的なメッセージが出てくるが、これで問題は治った。

# 明日やること
- USB メモリの中にあるデータを古い PC にバックアップする
- USB メモリに Ubuntu イメージをインストールする
- 小型パソコンに Ubuntu を再インストールする
- 以下のコマンドでディスクの中のデータを完全に削除する (途中で中断せずに最後まで実行する)
- 小型パソコンとキーボード、マウスを箱に詰めて返品する

```bash
$ shred -uvz <ディスク名>
```

# 今日一日の過ごし方
小型パソコンの返品や洗濯など、やることはいろいろとあったのだが、ついついゲームにはまってしまい、太鼓の達人やマリカなどをずっとやってしまっていた。そして小型パソコンのデータ消去の作業に入ったのがもう夜で、さらにその作業で面倒なことも起こしてしまったので完全に時間がなくなってしまった。やるべきことは早く済ませる習慣を身に着けたい。

今日はエンジェルドリームをフルコンした。

![img_0345](/images/2018/11/img_0345.jpg)

Nintendo Switch の Pro コンや Joy-Con よりも PS4 のコントローラのほうが操作しやすく良いスコアが出ることがわかった。

それと、Joy-Con で思いだしたのだが、そしてもうかなり寝る時間をオーバーしているので、本当はもっとしっかり書きたかったのだが、Joy-Con がどうも故障らしい。スティックが勝手に反応してカーソルが移動してしまう。前に同期と一緒に遊んだときから故障していたっぽいのだが、Joy-Con は基本的に使わない (プロコンメイン) ので忘れていた[^try-joy-con-with-taiko]。[Nintendo Switch のサポートページ](https://support.nintendo.co.jp/app/answers/detail/a_id/33812) に書かれている対処法を全部試してもダメだったので、故障ということで間違いなさそうだ。これも返品とは別に修理に出さないといけなさそうなので面倒くさい。

[^try-joy-con-with-taiko]: どうもプロコンで太鼓の達人をプレイするときにうまく操作できなかったので Joy-Con ならどうだろうかと思い、Joy-Con を久しぶり使ったことでこのことを思い出した。結局、太鼓の達人自体は問題なくプレイできて、プロコンよりはほんのちょっとだけ操作はしやすいという程度で、やはり PS4 には敵わなかった

# 睡眠記録
| 就寝 | 起床 |
|:---:|:---:|
| > 02:00 | > 10:30 |

# スモールゴール
| 目標 | 達成状況 |
|:---:|:---:|
| 毎日本を 10 ページは読む | 07:15 / 10 ページ |
| 「腕立て伏せ 10 回、腹筋 15 回、スクワット 20 回」を毎日やる | ✓ |
